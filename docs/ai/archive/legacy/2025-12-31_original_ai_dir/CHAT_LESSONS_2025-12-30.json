{
  "date": "2025-12-30",
  "title": "Wrap-up + layout stability hardening",
  "themes": [
    "constraint-driven compact layouts",
    "AppBar leading width/height budget",
    "deprecation hygiene",
    "patch discipline + handoff docs"
  ],
  "lessons": [
    {
      "id": "layout-001",
      "problem": "RenderFlex overflow in small surfaces (tests).",
      "root_cause": "Widget assumed more space than it actually received; parent compact flag did not reflect child constraints.",
      "fix": "Use LayoutBuilder inside critical blocks to compute effective compactness from constraints.",
      "rule": "If constraints are under the known safe threshold, force compact mode regardless of parent preference."
    },
    {
      "id": "layout-002",
      "problem": "AppBar leading overflow due to Row giving unbounded width.",
      "root_cause": "Row measures children at intrinsic width; text does not receive a maxWidth constraint.",
      "fix": "Use SizedBox(width: double.infinity, child: Column(...)) in leading slots.",
      "rule": "Avoid Row unless you truly need horizontal layout; constrain width explicitly when you do."
    },
    {
      "id": "hygiene-001",
      "problem": "Recurring analyzer noise (unused import, redundant !, deprecated withOpacity).",
      "root_cause": "Small hygiene items left behind during iteration.",
      "fix": "Treat deprecations and analyzer warnings as first-class cleanup whenever touching a file.",
      "rule": "If a file is opened for changes, exit with analyze-clean for that file."
    },
    {
      "id": "process-001",
      "problem": "Context drift during long sessions.",
      "root_cause": "Too many moving parts without a single source-of-truth handoff.",
      "fix": "Maintain docs/ai handoff + prompt files; update context_db.json patch log every patch.",
      "rule": "Every patch zip must include docs/ai/context_db.json and a patch_tracking entry."
    }
  ],
  "next_slice": {
    "name": "Dashboard grid + tool modals",
    "deliverables": [
      "Scrollable dashboard grid with + placeholders",
      "Tool modals with input + 10-entry history log",
      "Theme consistency pass (Dracula)",
      "Keep widget tests passing"
    ]
  }
}
