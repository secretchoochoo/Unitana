# Retro: Stabilization sprint (Dec 2025)

## Goal
Ship a booting Unitana build with the theme token system, the first-run wizard intact, and a dashboard that renders cleanly on small iPhone viewports.

## Start
- **Budget layout up front**: treat every tile as a fixed, small container first; add content only if it fits.
- **Make sections optional by default**: secondary lines, hints, and footers should be omitted when empty (not rendered as empty Widgets).
- **Use null-safe theming**: `Theme.of(context).extension<T>()` can be null; every access should have a sane fallback.
- **Prefer diffs over rewrites**: implement changes via small, targeted patches; avoid re-pasting whole files.
- **Encode special symbols deliberately**: degrees (\u00B0), euro (\u20AC), and other non-ASCII characters should be stable in source and tests.

## Stop
- **Stop letting tiles fail hard on content**: if text is uncertain, keep it minimal rather than making the layout fight.
- **Stop using `!` defensively**: null assertions are for invariants; UI is not an invariant.
- **Stop “fixing” overflow with clip widgets**: clipping hides the symptom and keeps the layout error.
- **Stop unstructured large edits**: when a change spans many files, write a plan first, then execute slice by slice.

## Continue
- **Continue with theme tokens**: the visual direction is cohesive; keep consolidating tokens and removing one-off values.
- **Continue small-device testing**: keep an iPhone-size simulator in the test loop.
- **Continue the patch-driven workflow**: it makes regressions obvious and reversible.

## What went well
- Fast iteration to isolate the culprit component (a single tile) instead of reworking the whole dashboard.
- Moving repeated UI patterns into a shared tile component simplified fixes and reduced duplicate layout logic.

## What went wrong
- The tile component originally assumed all content sections always exist, then expanded into a fixed-height box.
- A null assertion slipped into UI code during a quick refactor and took down the whole dashboard.

## Action items
1. Add a lightweight “tile layout budget” guideline (see CLEANUP_HARDENING_PLAN).
2. Add a widget test that renders the dashboard at iPhone SE size and asserts no overflow.
3. Add a linter rule or CI check to discourage `!` in UI widget code.
